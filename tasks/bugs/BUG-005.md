# BUG-005: 701 trades have corrupted timestamps (epoch 1969)

**Severity:** CRITICAL
**Found:** 2026-02-05
**Found By:** Audit Layer 4 (Runtime)
**Status:** FIXED (prevention) / OPEN (data cleanup)

## Evidence
701 open trades in trade_journal have entry_time = '1969-12-31T17:00:02'.
Root cause: market_feed.py defaults timestamp to 0 when WebSocket 'T' key is missing.
datetime.fromtimestamp(0/1000) = Unix epoch = 1969-12-31 in PST.

## Root Cause
market_feed.py lines 439 and 511: int(data.get('T', 0)) produces 0 or small values
when Bybit WebSocket messages lack the 'T' timestamp key.

## Fix
Added timestamp validation at both PriceTick creation points:

1. src/market_feed.py line 440-441 (_handle_bybit_trade):
   ```python
   if timestamp < 1000000000000:  # Invalid timestamp (before ~2001 in ms)
       timestamp = int(time.time() * 1000)
   ```

2. src/market_feed.py line 514-515 (_handle_binance_trade):
   ```python
   if timestamp < 1000000000000:  # Invalid timestamp (before ~2001 in ms)
       timestamp = int(time.time() * 1000)
   ```

## Remaining Work
- Data cleanup: 701 orphaned open trades need entry_time updated from created_at
- This fix prevents future bad timestamps but doesn't repair existing data

## Verification
- grep confirms fallback logic added at both PriceTick creation points
- time module already imported (line 12)
- Full test suite passes (835 passed, 1 skipped)

## Fixed In
TBD - pending commit
